<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Because I can!'>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Hugo Static Site on GitHub - Customizations • Praveen Lobo'>
<meta property='og:description' content='Because I can!'>
<meta property='og:url' content='https://praveenlobo.com/blog/hugo-static-site-on-github-customizations/'>
<meta property='og:site_name' content='Praveen Lobo'>
<meta property='og:type' content='article'><meta property='article:section' content='blog'><meta property='article:tag' content='hugo'><meta property='article:tag' content='static site'><meta property='article:published_time' content='2018-04-27T13:00:00Z'/><meta property='article:modified_time' content='2018-04-27T13:00:00Z'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.62.2" />

  <title>Hugo Static Site on GitHub - Customizations • Praveen Lobo</title>
  <link rel='canonical' href='https://praveenlobo.com/blog/hugo-static-site-on-github-customizations/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.6a060eb7.css'><style>
:root{--color-accent:#ffcd00;}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-20788457-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>
<body class='page type-blog'>

  <div class='site'><a class='screen-reader-text' href='#content'>Skip to Content</a><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    
    <ul><li class='item'>
        <a href='/'>Home</a>
      </li><li class='item'>
        <a href='/search'>Search</a>
      </li><li class='item'>
        <a href='/blog'>Blog</a>
      </li><li class='item'>
        <a href='/reviews-and-referral-links'>Reviews</a>
      </li><li class='item'>
        <a href='/archive'>Archive</a>
      </li><li class='item'>
        <a href='/subscribe'>Subscribe</a>
      </li><li class='item'>
        <a href='/contact'>Contact</a>
      </li><li class='item'>
        <a href='/about'>About</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Praveen Lobo</p><p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Hugo Static Site on GitHub - Customizations</h1>
      
<p class='desc'>Because I can!</p>


    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2018-04-27T13:00:00Z'>Fri, Apr 27, 2018</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
6 mins read
</span>


</div>


  </div>
</header>

  
  
<details class='container entry-toc'>
  <summary class='title'>
    <span>Table of Contents</span>
  </summary>
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#hugos-default-publish-directory">Hugo's default publish directory</a></li>
        <li><a href="#theme-as-a-regular-folder">Theme as a regular folder</a></li>
        <li><a href="#content-organization">Content organization</a></li>
        <li><a href="#de-duplicating-the-media">De-duplicating the media</a></li>
      </ul>
    </li>
  </ul>
</nav>
</details>


  <div class='container entry-content'>
  <p>While working on migrating this site from <a href="/blog/from-wordpress-to-a-static-site-generator/">WordPress to Hugo</a>, I did tweak somethings to make it work for my liking. I usually keep things simple so that future changes are as painless as possible, however, I decided to go ahead with these changes as it improved maintainability and reverting these changes are very straight forward.</p>
<h3 id="hugos-default-publish-directory">Hugo's default publish directory</h3>
<p>Hugo generates the static site content in <code>public</code> directory by default. This worked fine for me when I tried hosting this site on GitHub's <code>master</code> and <code>gh-pages</code> branches. The only <em>problem</em> was that the actual source code and the generated content were in two repositories and that is one more than what I wanted to maintain. Using a <code>submodule</code> approach worked fine, but I think it complicates the setup unnecessarily and is easy to mess up.</p>
<p>I wanted to keep it simple and all in one place and that's around the same time GitHub announced <a href="https://blog.github.com/2016-08-17-simpler-github-pages-publishing/">publishing from <code>docs</code> folder</a>. Exactly what I wanted and at the right time! Yes, that was 2016 and this post was long overdue!</p>
<p>I have set Hugo to use <code>docs</code> as the publish folder and set GitHub Pages to publish the site from <code>docs</code> folder on the master branch.</p>
<pre><code>publishdir = &quot;docs&quot;
</code></pre><h3 id="theme-as-a-regular-folder">Theme as a regular folder</h3>
<p>Instead of setting up the theme using Git's <code>submodule</code>, I just keep the theme as a regular folder to avoid using <code>submodule</code>. I make sure to watch the theme repo on GitHub so that I get notified about any changes to the theme. I then decide when to get the latest changes.</p>
<p>Another reason for doing this is sometimes I find it easier to edit the theme a little to make it work for me. Editing the source files from another repo is something to avoid as it makes upgrading difficult, but this was an easy way out. Hugo does provide a way to override the theme with <code>layouts</code>; however, I haven't really put anytime into making it work that way.</p>
<h3 id="content-organization">Content organization</h3>
<p>I had about 125 content files directly under <code>content\blog\</code> neatly ordered <code>YYYY-MM-DD</code> due to filename and it got old really quick. It was annoying when I was trying to look for something or add a new post. I can't imagine maintaining a huge site with a lot of files this way - doable but not my style. I broke down the blog folder into sub-folders based on the year the post was published. The content is now easier to handle.</p>
<p>When the content is moved to different folders, the URLs of the content files change based on where the content file is located. To avoid the URL change, I defined where the content should be shown using the  <code>slug</code> variable in the front matter.</p>
<p>After the reorganization, all I had to do was search and replace all occurrences of <code>slug = &quot;</code> with <code>slug = &quot;../</code>. This worked as I wanted the URL to remain the same as before and wanted to remove the additional <code>/YYYY/</code> due to the re-org. This can be achieved using the <code>url</code> variable as well.</p>
<p>Note that I had to do this because I don't use the <code>permalinks</code> variable in the Hugo config. My content files are named <code>YYYY-MM-DD-&lt;file/title name&gt;</code> from WordPress extraction and I already had some posts whose URL didn't match the filename so I was already using slugs to keep URLs clean.</p>
<p>I did break down the <code>media</code> folder similar to content files but they are ordered just by numerals. This was a breeze thanks to pattern matching and back-referencing in regex find and replace.</p>
<h3 id="de-duplicating-the-media">De-duplicating the media</h3>
<p>In my site repo, I had the media in two places. One under <code>static/media</code> and the other under the published directory <code>docs/media</code>. The total size of media in my case is around 1MB which is just fine but this could be a problem if the size of the media directory is huge.</p>
<p>To de-duplicate the media on the Hugo site repository, I came up with the following strategy.</p>
<ol>
<li>Place the <code>media</code> folder in the Hugo recommended <code>static</code> directory.</li>
<li>Create a <code>.gitignore</code> file to ignore <code>static/media/</code> folder so that this never gets added to the repo.</li>
<li>Build Hugo site. The <code>media</code> folder gets copied from <code>static</code> folder to the publish directory <code>docs</code></li>
</ol>
<p>This worked exactly as I planned - two copies of media in local and one in repository. When the repository is pushed to GitHub, it ignored the <code>static/media/</code> folder so the repository had exactly one copy of the media. This approach came with caveats - if I was cloning the repository, I would have only one copy in the <code>docs</code> folder which meant the <code>hugo server</code> command would not render any media. Worse yet, my build step that cleared the publish directory used to remove the only copy of the media. I could fix the build step but the other problem would still remain. To avoid this, I built a clone script that would clone and copy the media folder to static folder right-away.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ git clone https://github.com/lobopraveen/praveenlobo.com.git
$ cd praveenlobo.com
$ cp -r docs/media static/media
</code></pre></div><p>I did take this one step further by creating a symlink instead of copying the media to static directory. This is my preferred approach and it works fine for me as I don't use Microsoft Windows.</p>
<ol>
<li>Place the <code>media</code> folder in the Hugo's publish directory <code>docs</code></li>
<li>Create a symlink in <code>static</code> directory to follow the actual media directory. This is required to make the <code>hugo server</code> render media properly when run locally.<br>
<code>$ ln -s ../docs/media/ media</code></li>
<li>Update the clean-up script to retain the <code>media</code> in the publish directory<br>
<code>$ find docs -mindepth 1 -maxdepth 1 ! -name media -exec rm -rf {} \;</code></li>
</ol>
<p>This approach works well as GitHub supports the symlinks and it works fine with Hugo even though it throws the following error on <code>hugo server</code> command as symlinks are not officially supported due to platform dependency.</p>
<blockquote>
<p>ERROR 2018/04/27 17:16:36 Symbolic links for directories not supported, skipping &ldquo;/home/lobo/blog/praveenlobo.com/static/media&rdquo;</p>
</blockquote>
<p>While running the server, Hugo doesn't actually build the site which means it uses the <code>static/media</code> folder and since this is on the local machine, browser's media request follows the symlinks and render the media properly. Hugo ignores/skips the symlinks while building the site which is what I want as the media is already in the publish folder.</p>
<p>All these customizations are visible on the <a href="https://github.com/lobopraveen/praveenlobo.com">GitHub repository of this site</a>.</p>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span><a class='category' href='/categories/1/'>1</a></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/hugo/'>hugo</a>, <a class='tag' href='/tags/static-site/'>static site</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/blog/from-wordpress-to-a-static-site-generator/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>From WordPress to A Static Site Generator</a>
    </div><div class='next-entry sep-before'>
      <a href='/blog/markitedm-classic-matcher-hands-on-notes/'>
        <span class='screen-reader-text'>Next post: </span>Markit EDM Classic Matcher Hands On Notes<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>


<section id='comments' class='comments'>
  <div class='container sep-before'>
    <div class='comments-area'><div id='submission-success' class='comment-submission-feedback'>
  <h4>Thank You!</h4>
  <span>Your comment has been submitted. It will appear on this page shortly!</span>
  <a href='#comments' class='button'>OK</a>
</div>

<div id='submission-failure' class='comment-submission-feedback'>
  <h4>Yikes, Sorry!</h4>
  <span>Error occured. Couldn&#39;t submit your comment. Please try again. Thank You!</span>
  <a href='#comments' class='button'>OK</a>
</div>




<div id='respond' class='comment-respond'>
  <h4 class='comment-reply-title'>Leave a comment<small>
      <a rel='nofollow' id='cancel-comment-reply-link' href='#respond' class='button' style='display:none' aria-label='Cancel comment'>Cancel</a>
    </small>
  </h4>
  <form action='https://api.staticman.net/v2/entry/lobopraveen/praveenlobo.com/master/comments' method='post' id='comment-form' class='comment-form'>
    <input type='hidden' name='options[postId]' value='ec11bf1f6f1df0ea60309b623750d5b0'>
    <input type='hidden' name='options[redirect]' value='https://praveenlobo.com/blog/hugo-static-site-on-github-customizations/#submission-success'>
    <input type='hidden' name='options[redirectError]' value='https://praveenlobo.com/blog/hugo-static-site-on-github-customizations/#submission-failure'>

    <input type='address' name='fields[honeypot]' style='display:none'>
    <input type='hidden' name='fields[permalink]' value='/blog/hugo-static-site-on-github-customizations/'>
    <input type='hidden' name='fields[parent_id]' value=''><input type='hidden' name='options[reCaptcha][siteKey]' value='6LeSCGoUAAAAADS2jeaiTgzwi_hIQQ2uVumPxpsp'>
      <input type='hidden' name='options[reCaptcha][secret]' value='Wb4JOmR/cOt0fkaJ9gKxRarj8ADX1rSsI/jSVhpkNlINwcPCBSSfNKcZrDvQs8sSrQAUPWDILqHpYubB2TFR1raeVjrHuKvwChypXYOQzgN5lIEiL/8dN0UkG9kAc5qbheLJldGnaEiZiDrBTZmCM0kopP&#43;G/MtNjrVXfKvigZo='><div>
      <label for='comment'>Comment*</label>
      <textarea id='comment' name='fields[content]' required rows='3'></textarea>
    </div>
    <div>
      <label for='name'>Name*</label>
      <input id='name' name='fields[author]' type='text' required>
    </div>
    <div>
      <label for='email'>Email*</label>
      <input id='email' name='fields[email]' type='email' required>
    </div>
    <div>
      <label for='url'>Website</label>
      <input id='url' name='fields[site]' type='url'>
    </div><div class='g-recaptcha' data-sitekey='6LeSCGoUAAAAADS2jeaiTgzwi_hIQQ2uVumPxpsp' data-callback="enableSubmitComment"></div>

      <script type="text/javascript">
        function enableSubmitComment(){
          document.getElementById("submitComment").disabled = false;
        }
      </script>

      <script async src='https://www.google.com/recaptcha/api.js'></script><div>
      <button type='submit' id="submitComment" disabled>Comment!</button>
    </div>
  </form>
</div>

</div>
  </div>
</section>

      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='mailto:gmail@praveenlobo.com' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/lobopraveen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
  <rect x="2" y="9" width="4" height="12"/>
  <circle cx="4" cy="4" r="2"/>
  
</svg>
</a>
      </li><li>
        <a href='https://github.com/lobopraveen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='%3cnil%3e319542' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Stackoverflow account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/lobopraveen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://instagram.com/lobopraveen' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Instagram account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
  <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
  <line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p> &copy; 2018-2020 Praveen Lobo </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.67d669ac.js'></script><script src='/js/custom.js'></script>

</body>

</html>

